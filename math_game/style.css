* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    overflow-x: hidden;
    transition: background 1s ease;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, transparent 0%, rgba(0, 0, 0, 0.5) 100%);
    pointer-events: none;
    z-index: 999;
}

body.era-1 {
    background: #3d2f1e url('assets/backgrounds/stage1_background.jpg') no-repeat center center fixed;
    background-size: cover;
}

body.era-2 {
    background: #2a1a08 url('assets/backgrounds/stage2_background.jpg') no-repeat center center fixed;
    background-size: cover;
}

body.era-3 {
    background: #0a1520 url('assets/backgrounds/stage3_background.jpg') no-repeat center center fixed;
    background-size: cover;
}

body.era-4 {
    background: #08051a url('assets/backgrounds/stage4_background.jpg') no-repeat center center fixed;
    background-size: cover;
}

body:not(.era-1):not(.era-2):not(.era-3):not(.era-4) {
    background: #4a3d2e url('assets/backgrounds/stage1_background.jpg') no-repeat center center fixed;
    background-size: cover;
}

.top-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 38px;
    background: linear-gradient(180deg, rgba(10, 12, 15, 0.98) 0%, rgba(5, 8, 12, 0.95) 100%);
    border-bottom: 2px solid rgba(255, 255, 255, 0.15);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    z-index: 500;
    backdrop-filter: blur(16px);
    box-shadow: 0 4px 40px rgba(0, 0, 0, 0.6), inset 0 -1px 0 rgba(255, 255, 255, 0.05);
}

.top-bar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.15) 20%, rgba(255, 255, 255, 0.25) 50%, rgba(255, 255, 255, 0.15) 80%, transparent 100%);
    pointer-events: none;
}

.top-bar::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    pointer-events: none;
}

.back-link {
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none;
    font-size: 14px;
    transition: color 0.2s, text-shadow 0.2s;
}

.back-link:hover { 
    color: #fff; 
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

.game-title {
    font-size: 22px;
    color: #fff;
    text-shadow: 0 0 30px rgba(255, 255, 255, 0.7), 0 0 60px rgba(200, 255, 230, 0.3);
    letter-spacing: 0.15em;
    font-weight: bold;
}

.settings-btn {
    font-size: 20px;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
    background: none;
    border: none;
    padding: 4px 8px;
    position: relative;
    z-index: 600;
    font-family: inherit;
}

.settings-btn:hover {
    color: #fff;
    transform: rotate(45deg);
    text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
}

.era-name {
    font-size: 16px;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    transition: all 0.5s;
    font-weight: bold;
}

body.era-1 .era-name {
    color: #ffd080;
    text-shadow: 0 0 30px rgba(220, 170, 100, 1), 0 0 60px rgba(180, 130, 60, 0.7);
}

body.era-2 .era-name {
    color: #ff9030;
    text-shadow: 0 0 35px rgba(255, 140, 40, 1), 0 0 70px rgba(255, 100, 10, 0.8);
}

body.era-3 .era-name {
    color: #70e0ff;
    text-shadow: 0 0 30px rgba(100, 220, 255, 1), 0 0 60px rgba(80, 200, 255, 0.7);
}

body.era-4 .era-name {
    background: linear-gradient(90deg, #ff6090, #ffb070, #90ff90, #70d0ff, #d090ff, #ff70d0);
    background-size: 200% 100%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: none;
    filter: drop-shadow(0 0 25px rgba(255, 255, 255, 1));
    animation: rainbowShift 3s linear infinite;
}

@keyframes rainbowShift {
    0%, 100% { filter: drop-shadow(0 0 15px rgba(255, 100, 150, 0.8)); }
    33% { filter: drop-shadow(0 0 15px rgba(100, 255, 150, 0.8)); }
    66% { filter: drop-shadow(0 0 15px rgba(100, 150, 255, 0.8)); }
}

.settings-panel {
    position: fixed;
    top: 50px;
    right: 360px;
    background: linear-gradient(180deg, rgba(30, 35, 32, 0.98) 0%, rgba(22, 28, 25, 0.99) 100%);
    border: 2px solid rgba(150, 200, 170, 0.4);
    border-radius: 10px;
    padding: 18px;
    z-index: 700;
    min-width: 180px;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
}

.settings-header {
    font-size: 16px;
    color: #fff;
    margin-bottom: 14px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.15);
}

.settings-option {
    display: block;
    width: 100%;
    background: rgba(255, 80, 80, 0.15);
    border: 2px solid rgba(255, 80, 80, 0.4);
    color: #ff9999;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    font-size: 14px;
    padding: 10px 14px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.15s;
    text-align: left;
}

.settings-option:hover {
    background: rgba(255, 80, 80, 0.25);
    border-color: rgba(255, 80, 80, 0.6);
    box-shadow: 0 0 15px rgba(255, 80, 80, 0.2);
}

.settings-close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.5);
    font-size: 18px;
    cursor: pointer;
    padding: 4px;
    line-height: 1;
}

.settings-close:hover {
    color: #fff;
}

.confirm-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
}

.confirm-box {
    background: linear-gradient(180deg, rgba(50, 35, 35, 0.98) 0%, rgba(40, 25, 25, 0.99) 100%);
    border: 3px solid rgba(255, 100, 100, 0.5);
    border-radius: 14px;
    padding: 28px 36px;
    text-align: center;
    box-shadow: 0 0 60px rgba(255, 50, 50, 0.3);
}

.confirm-text {
    font-size: 18px;
    color: #fff;
    margin-bottom: 24px;
    line-height: 1.5;
}

.confirm-buttons {
    display: flex;
    gap: 14px;
    justify-content: center;
}

.confirm-yes, .confirm-no {
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    font-size: 16px;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s;
}

.confirm-yes {
    background: rgba(255, 80, 80, 0.25);
    border: 2px solid rgba(255, 80, 80, 0.6);
    color: #ff9999;
}

.confirm-yes:hover {
    background: rgba(255, 80, 80, 0.4);
    border-color: rgba(255, 80, 80, 0.8);
    box-shadow: 0 0 20px rgba(255, 80, 80, 0.3);
}

.confirm-no {
    background: rgba(100, 200, 150, 0.2);
    border: 2px solid rgba(100, 200, 150, 0.5);
    color: #aaddcc;
}

.confirm-no:hover {
    background: rgba(100, 200, 150, 0.3);
    border-color: rgba(100, 200, 150, 0.7);
}

.stage-flash, .opm-flash {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    font-size: 52px;
    color: #9f9;
    text-shadow: 0 0 50px rgba(160, 255, 200, 0.9), 0 0 100px rgba(160, 255, 200, 0.5);
    opacity: 0;
    z-index: 2000;
    pointer-events: none;
    transition: all 0.5s ease-out;
}

.stage-flash.show, .opm-flash.show {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
}

.opm-flash {
    font-size: 40px;
    color: #ffcc44;
    text-shadow: 0 0 40px rgba(255, 200, 50, 0.9);
}

.bonus-problem-popup {
    position: fixed;
    transform: translate(-50%, -50%);
    background: linear-gradient(180deg, rgba(35, 75, 55, 0.98) 0%, rgba(25, 60, 42, 0.99) 100%);
    border: 2px solid rgba(140, 255, 190, 0.6);
    border-radius: 20px;
    padding: 28px 36px;
    z-index: 1000;
    box-shadow: 0 15px 60px rgba(0, 0, 0, 0.5), 0 0 100px rgba(140, 255, 190, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    animation: bonusPulse 1s ease-in-out infinite alternate;
    overflow: hidden;
}

.bonus-problem-popup::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.06) 0%, transparent 100%);
    pointer-events: none;
    border-radius: 18px 18px 0 0;
}

@keyframes bonusPulse {
    from { box-shadow: 0 15px 60px rgba(0, 0, 0, 0.5), 0 0 80px rgba(140, 255, 190, 0.35); }
    to { box-shadow: 0 15px 70px rgba(0, 0, 0, 0.55), 0 0 140px rgba(160, 255, 200, 0.5); }
}

.bonus-header {
    font-size: 22px;
    color: #aff;
    text-align: center;
    margin-bottom: 10px;
    text-shadow: 0 0 25px rgba(170, 255, 220, 0.9);
}

.bonus-timer {
    font-size: 32px;
    color: #fff;
    text-align: center;
    margin-bottom: 6px;
    text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
}

.bonus-reward {
    font-size: 14px;
    color: rgba(220, 255, 240, 0.9);
    text-align: center;
    margin-bottom: 18px;
}

.bonus-input-row {
    display: flex;
    align-items: center;
    gap: 14px;
    justify-content: center;
}

.bonus-text { 
    font-size: 28px; 
    color: #fff; 
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

.bonus-input {
    width: 130px;
    background: rgba(0, 0, 0, 0.6);
    border: 3px solid rgba(140, 255, 190, 0.6);
    border-radius: 8px;
    padding: 10px 12px;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    font-size: 28px;
    color: #fff;
    text-align: center;
    outline: none;
}

.bonus-input:focus {
    border-color: rgba(140, 255, 190, 0.9);
    box-shadow: 0 0 25px rgba(140, 255, 190, 0.4);
}

.hack-panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(180deg, rgba(80, 25, 25, 0.98) 0%, rgba(50, 15, 15, 0.99) 100%);
    border: 3px solid rgba(255, 100, 100, 0.7);
    border-radius: 20px;
    padding: 24px 32px;
    z-index: 1100;
    box-shadow: 0 15px 60px rgba(0, 0, 0, 0.6), 0 0 120px rgba(255, 50, 50, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    animation: hackPulse 0.5s ease-in-out infinite alternate;
    min-width: 320px;
}

@keyframes hackPulse {
    from { box-shadow: 0 15px 60px rgba(0, 0, 0, 0.6), 0 0 80px rgba(255, 50, 50, 0.4); border-color: rgba(255, 100, 100, 0.7); }
    to { box-shadow: 0 15px 70px rgba(0, 0, 0, 0.7), 0 0 150px rgba(255, 80, 80, 0.6); border-color: rgba(255, 150, 150, 0.9); }
}

.hack-header {
    font-size: 20px;
    color: #ff6060;
    text-align: center;
    margin-bottom: 16px;
    text-shadow: 0 0 30px rgba(255, 80, 80, 0.9);
    letter-spacing: 0.2em;
    animation: hackFlicker 0.1s infinite;
}

@keyframes hackFlicker {
    0%, 90%, 100% { opacity: 1; }
    92%, 98% { opacity: 0.7; }
}

.hack-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 24px;
}

.hack-ops-left {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.hack-ops-label {
    font-size: 10px;
    color: rgba(100, 255, 100, 0.8);
    letter-spacing: 0.15em;
    margin-bottom: 4px;
}

.hack-ops-value {
    font-size: 36px;
    color: #60ff60;
    text-shadow: 0 0 20px rgba(100, 255, 100, 0.8);
    font-weight: bold;
}

.hack-time-left {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
}

.hack-time-label {
    font-size: 10px;
    color: rgba(255, 100, 100, 0.8);
    letter-spacing: 0.15em;
    margin-bottom: 4px;
}

.hack-time-bar {
    width: 100%;
    height: 24px;
    background: rgba(0, 0, 0, 0.5);
    border: 2px solid rgba(255, 100, 100, 0.5);
    border-radius: 6px;
    overflow: hidden;
}

.hack-time-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff3030, #ff6060);
    box-shadow: 0 0 15px rgba(255, 50, 50, 0.6);
    transition: width 0.1s linear;
    width: 100%;
}

.hack-problem-area {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 14px;
}

.hack-problem-text {
    font-size: 24px;
    color: #fff;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

.hack-input {
    width: 120px;
    background: rgba(0, 0, 0, 0.6);
    border: 3px solid rgba(255, 100, 100, 0.6);
    border-radius: 8px;
    padding: 10px 12px;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    font-size: 24px;
    color: #fff;
    text-align: center;
    outline: none;
}

.hack-input:focus {
    border-color: rgba(255, 150, 150, 0.9);
    box-shadow: 0 0 25px rgba(255, 100, 100, 0.4);
}

.active-effects {
    position: fixed;
    top: 100px;
    right: 350px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    z-index: 100;
}

.effect-badge {
    padding: 8px 14px;
    border-radius: 6px;
    font-size: 14px;
    text-shadow: 0 0 10px currentColor;
}

.effect-badge.facility {
    background: rgba(100, 200, 255, 0.3);
    border: 2px solid rgba(100, 200, 255, 0.6);
    color: #9df;
}

.effect-badge.solve {
    background: rgba(255, 200, 100, 0.3);
    border: 2px solid rgba(255, 200, 100, 0.6);
    color: #fd9;
}

.main-content {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 24px;
    padding: 60px 20px 20px;
    transform: translateX(-7%);
}

.left-panel {
    width: 190px;
    background: linear-gradient(180deg, rgba(35, 45, 40, 0.97) 0%, rgba(25, 35, 30, 0.98) 100%);
    border: 2px solid rgba(150, 200, 170, 0.35);
    border-radius: 16px;
    padding: 22px;
    display: flex;
    flex-direction: column;
    gap: 18px;
    transition: all 0.5s;
    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.05), inset 0 0 30px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden;
}

.left-panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 60%;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.03) 0%, transparent 100%);
    pointer-events: none;
    border-radius: 14px 14px 0 0;
}

.left-panel::after {
    content: '';
    position: absolute;
    top: 8px;
    left: 10px;
    right: 10px;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(200, 255, 230, 0.25), transparent);
    pointer-events: none;
}

body.era-1 .left-panel {
    background: linear-gradient(180deg, rgba(100, 75, 45, 0.97) 0%, rgba(70, 50, 30, 0.98) 100%);
    border: 4px solid rgba(240, 190, 100, 0.8);
    box-shadow: 0 0 35px rgba(180, 130, 60, 0.4), inset 0 0 40px rgba(80, 50, 25, 0.5);
}

body.era-2 .left-panel {
    background: linear-gradient(180deg, rgba(80, 45, 20, 0.97) 0%, rgba(55, 35, 15, 0.98) 100%);
    border: 4px solid rgba(255, 160, 60, 0.85);
    box-shadow: 0 0 40px rgba(255, 120, 30, 0.35), inset 0 0 35px rgba(100, 50, 15, 0.5);
}

body.era-3 .left-panel {
    background: linear-gradient(180deg, rgba(20, 45, 80, 0.97) 0%, rgba(15, 35, 60, 0.98) 100%);
    border: 4px solid rgba(100, 200, 255, 0.75);
    box-shadow: 0 0 40px rgba(80, 180, 255, 0.3), inset 0 0 40px rgba(15, 40, 80, 0.5);
}

body.era-4 .left-panel {
    background: linear-gradient(180deg, rgba(30, 22, 60, 0.97) 0%, rgba(22, 15, 50, 0.98) 100%);
    border: 4px solid transparent;
    border-image: linear-gradient(135deg, rgba(255, 120, 170, 0.85), rgba(120, 220, 255, 0.85), rgba(170, 255, 170, 0.85), rgba(255, 220, 120, 0.85)) 1;
    box-shadow: 0 0 50px rgba(180, 130, 255, 0.35), inset 0 0 45px rgba(40, 30, 80, 0.55);
}

.complexity-display {
    text-align: center;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.stage-progress {
    height: 8px;
    background: linear-gradient(180deg, rgba(100, 160, 140, 0.2) 0%, rgba(80, 140, 120, 0.15) 100%);
    border-radius: 6px;
    overflow: hidden;
    margin: 12px 0 6px;
    border: 1px solid rgba(140, 200, 170, 0.2);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
}

.stage-fill {
    height: 100%;
    background: linear-gradient(90deg, #6c8, #8ea, #afc);
    background-size: 200% 100%;
    width: 0%;
    transition: width 0.3s ease;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(140, 220, 180, 0.5);
    animation: progressShine 2s linear infinite;
}

@keyframes progressShine {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

.stage-next {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.55);
}

.stats-section {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 16px 12px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
    border-radius: 10px;
    margin: 0 -6px;
    border: 1px solid rgba(255, 255, 255, 0.04);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.03);
}

.stat-row {
    display: flex;
    justify-content: space-between;
    font-size: 13px;
}

.stat-name { color: rgba(255, 255, 255, 0.85); font-weight: bold; }
.stat-val { color: #dff; text-shadow: 0 0 15px rgba(220, 255, 255, 0.6); font-weight: bold; }

.complexity-section {
    text-align: center;
    padding: 14px 0;
    margin-top: auto;
}

.symbol-flicker {
    font-size: 22px;
    color: rgba(220, 255, 240, 1);
    text-shadow: 0 0 20px rgba(200, 255, 230, 0.9);
    font-family: monospace;
    margin-bottom: 8px;
    position: relative;
}

.symbol-flicker::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 80px;
    height: 80px;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle, rgba(180, 255, 220, 0.15) 0%, transparent 70%);
    border-radius: 50%;
    pointer-events: none;
    z-index: -1;
    animation: sigilAura 3s ease-in-out infinite;
}

@keyframes sigilAura {
    0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
    50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
}

.bit-display {
    font-size: 48px;
    color: #bff;
    text-shadow: 0 0 40px rgba(180, 255, 250, 1), 0 0 70px rgba(150, 255, 230, 0.5);
    transition: all 0.3s;
    line-height: 1.2;
    font-weight: bold;
}

body.era-1 .bit-display {
    color: #ffd090;
    text-shadow: 0 0 35px rgba(240, 180, 100, 1), 0 0 70px rgba(200, 150, 70, 0.6);
}

body.era-2 .bit-display {
    color: #ffa040;
    text-shadow: 0 0 40px rgba(255, 150, 60, 1), 0 0 80px rgba(255, 120, 30, 0.7);
}

body.era-3 .bit-display {
    color: #70e0ff;
    text-shadow: 0 0 40px rgba(100, 220, 255, 1), 0 0 80px rgba(80, 200, 255, 0.6);
}

body.era-4 .bit-display {
    background: linear-gradient(45deg, #ff90a0, #a0ff90, #a0a0ff, #ffa0ff);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: none;
    filter: drop-shadow(0 0 30px rgba(255, 220, 255, 1));
    animation: rainbowText 3s ease infinite;
}

.bit-display.glowing {
    animation: bitGlow 1s ease-in-out infinite alternate;
    text-shadow: 0 0 35px rgba(170, 255, 240, 1), 0 0 60px rgba(140, 255, 200, 0.6);
}

.bit-display.glowing-intense {
    animation: bitGlowIntense 0.5s ease-in-out infinite alternate;
    color: #fff;
    text-shadow: 0 0 45px rgba(255, 255, 255, 1), 0 0 80px rgba(170, 255, 240, 0.8);
}

@keyframes bitGlow {
    from { text-shadow: 0 0 25px rgba(170, 255, 240, 0.8); transform: scale(1); }
    to { text-shadow: 0 0 45px rgba(170, 255, 240, 1), 0 0 70px rgba(140, 255, 200, 0.5); transform: scale(1.02); }
}

@keyframes bitGlowIntense {
    from { text-shadow: 0 0 45px rgba(255, 255, 255, 1), 0 0 80px rgba(170, 255, 240, 0.8); transform: scale(1); }
    to { text-shadow: 0 0 70px rgba(255, 255, 255, 1), 0 0 120px rgba(255, 220, 140, 0.9); transform: scale(1.05); }
}

.next-bonus {
    display: none;
}

.bonus-label {
    display: block;
    font-size: 10px;
    color: rgba(255, 255, 255, 0.5);
    margin-bottom: 3px;
}

.bonus-countdown {
    font-size: 18px;
    color: #afc;
    text-shadow: 0 0 12px rgba(170, 255, 200, 0.5);
}

.game-box {
    width: 420px;
    background: linear-gradient(180deg, rgba(45, 55, 50, 0.97) 0%, rgba(32, 42, 36, 0.98) 100%);
    border: 2px solid rgba(160, 220, 190, 0.4);
    border-radius: 16px;
    padding: 24px;
    transition: all 0.5s;
    box-shadow: 0 12px 60px rgba(0, 0, 0, 0.45), 0 0 80px rgba(100, 180, 150, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.06), inset 0 0 40px rgba(0, 0, 0, 0.25);
    position: relative;
    overflow: hidden;
}

.game-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.04) 0%, transparent 100%);
    border-radius: 18px 18px 0 0;
    pointer-events: none;
}

.game-box::after {
    content: '';
    position: absolute;
    top: 10px;
    left: 20px;
    right: 20px;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(200, 255, 230, 0.2), transparent);
    pointer-events: none;
}

.game-box.purchase-flash {
    box-shadow: 0 0 60px rgba(100, 255, 180, 0.4);
}

.game-box.era-1 {
    background: linear-gradient(180deg, rgba(110, 85, 55, 0.97) 0%, rgba(75, 55, 35, 0.98) 100%);
    border: 5px solid rgba(250, 200, 120, 0.9);
    box-shadow: 0 0 60px rgba(220, 160, 80, 0.45), inset 0 0 60px rgba(100, 65, 30, 0.5);
}

.game-box.era-1::before {
    background: linear-gradient(135deg, rgba(250, 210, 130, 0.2) 0%, transparent 50%, rgba(250, 210, 130, 0.2) 100%);
}

.game-box.era-2 {
    background: linear-gradient(180deg, rgba(90, 50, 25, 0.97) 0%, rgba(60, 35, 18, 0.98) 100%);
    border: 5px solid rgba(255, 140, 45, 0.95);
    box-shadow: 0 0 80px rgba(255, 120, 30, 0.5), inset 0 0 60px rgba(130, 65, 15, 0.5);
}

.game-box.era-2::before {
    background: linear-gradient(135deg, rgba(255, 170, 70, 0.25) 0%, transparent 50%, rgba(255, 170, 70, 0.25) 100%);
}

.game-box.era-3 {
    background: linear-gradient(180deg, rgba(25, 55, 95, 0.97) 0%, rgba(18, 42, 75, 0.98) 100%);
    border: 5px solid rgba(80, 200, 255, 0.9);
    box-shadow: 0 0 70px rgba(100, 200, 255, 0.4), inset 0 0 50px rgba(25, 60, 110, 0.55);
}

.game-box.era-3::before {
    background: linear-gradient(135deg, rgba(120, 220, 255, 0.2) 0%, transparent 50%, rgba(120, 220, 255, 0.2) 100%);
}

.game-box.era-4 {
    background: linear-gradient(180deg, rgba(35, 28, 70, 0.97) 0%, rgba(25, 20, 55, 0.98) 100%);
    border: 5px solid transparent;
    border-image: linear-gradient(135deg, rgba(255, 120, 170, 1), rgba(120, 255, 220, 1), rgba(120, 200, 255, 1), rgba(220, 120, 255, 1)) 1;
    box-shadow: 0 0 100px rgba(180, 130, 255, 0.5), 0 0 180px rgba(120, 220, 255, 0.3), inset 0 0 70px rgba(50, 40, 100, 0.55);
    animation: era4Shimmer 4s ease-in-out infinite;
}

.game-box.era-4::before {
    background: linear-gradient(135deg, rgba(255, 130, 220, 0.2) 0%, rgba(120, 255, 220, 0.15) 50%, rgba(120, 220, 255, 0.2) 100%);
}

@keyframes era4Shimmer {
    0%, 100% { box-shadow: 0 0 60px rgba(120, 200, 255, 0.3), 0 0 120px rgba(140, 220, 255, 0.15), inset 0 0 50px rgba(60, 40, 100, 0.3); }
    50% { box-shadow: 0 0 80px rgba(140, 220, 255, 0.4), 0 0 150px rgba(160, 240, 255, 0.2), inset 0 0 60px rgba(80, 50, 120, 0.4); }
}

.computations-display {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 28px;
    padding: 20px;
    background: linear-gradient(180deg, rgba(0, 0, 0, 0.15) 0%, rgba(0, 0, 0, 0.08) 100%);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.06);
    position: relative;
}

.computations-display::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
}

.comp-value {
    font-size: 64px;
    color: #cff;
    text-shadow: 0 0 60px rgba(200, 255, 250, 1), 0 0 100px rgba(150, 255, 230, 0.5);
    font-weight: bold;
}

body.era-1 .comp-value {
    color: #ffe0a0;
    text-shadow: 0 0 50px rgba(255, 200, 120, 1), 0 0 100px rgba(220, 160, 80, 0.7);
}

body.era-2 .comp-value {
    color: #ffb060;
    text-shadow: 0 0 55px rgba(255, 160, 80, 1), 0 0 110px rgba(255, 120, 30, 0.8);
}

body.era-3 .comp-value {
    color: #80e0ff;
    text-shadow: 0 0 55px rgba(120, 220, 255, 1), 0 0 110px rgba(90, 200, 255, 0.6);
}

body.era-4 .comp-value {
    background: linear-gradient(45deg, #ff9090, #ffff90, #90ff90, #90ffff, #9090ff, #ff90ff);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: rainbowText 4s ease infinite;
    filter: drop-shadow(0 0 35px rgba(255, 255, 255, 1)) drop-shadow(0 0 70px rgba(200, 150, 255, 0.6));
}

@keyframes rainbowText {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.comp-label {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
    text-transform: uppercase;
    letter-spacing: 0.12em;
}

.comp-rate {
    font-size: 18px;
    color: #cee;
    margin-top: 6px;
    text-shadow: 0 0 12px rgba(200, 240, 240, 0.4);
}

.problem-area {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.problem-stack {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
}

.input-row {
    display: flex;
    align-items: center;
    gap: 14px;
    flex-wrap: wrap;
    justify-content: center;
}

.problem-text {
    font-size: 30px;
    color: #fff;
    white-space: pre-wrap;
    text-align: center;
    line-height: 1.4;
    max-width: 440px;
    min-height: 36px;
    text-shadow: 0 0 30px rgba(255, 255, 255, 0.7), 0 0 60px rgba(200, 255, 230, 0.3);
    letter-spacing: 0.03em;
    font-weight: bold;
}

.answer-input {
    width: 185px;
    background: linear-gradient(180deg, rgba(15, 28, 22, 0.98) 0%, rgba(8, 18, 12, 0.99) 100%);
    border: 3px solid rgba(160, 240, 200, 0.6);
    border-radius: 14px;
    padding: 16px 20px;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    font-size: 40px;
    color: #fff;
    text-align: center;
    outline: none;
    transition: all 0.2s ease;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 40px rgba(140, 220, 180, 0.25), inset 0 2px 0 rgba(255, 255, 255, 0.05), inset 0 0 25px rgba(0, 0, 0, 0.4);
    font-weight: bold;
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
}

.answer-input:focus {
    border-color: rgba(180, 255, 220, 1);
    box-shadow: 0 4px 25px rgba(0, 0, 0, 0.35), 0 0 60px rgba(160, 255, 210, 0.5), 0 0 100px rgba(140, 255, 200, 0.2), inset 0 2px 0 rgba(255, 255, 255, 0.08), inset 0 0 30px rgba(100, 200, 170, 0.15);
    transform: scale(1.02);
}

body.era-1 .answer-input {
    background: rgba(50, 35, 20, 0.95);
    border: 4px solid rgba(200, 160, 90, 0.75);
    box-shadow: 0 0 25px rgba(180, 140, 70, 0.3);
}
body.era-1 .answer-input:focus {
    border-color: rgba(230, 190, 110, 1);
    box-shadow: 0 0 45px rgba(200, 160, 90, 0.6);
}

body.era-2 .answer-input {
    background: rgba(45, 28, 15, 0.95);
    border: 4px solid rgba(255, 130, 40, 0.8);
    box-shadow: 0 0 25px rgba(255, 110, 30, 0.3);
}
body.era-2 .answer-input:focus {
    border-color: rgba(255, 150, 60, 1);
    box-shadow: 0 0 50px rgba(255, 120, 40, 0.6);
}

body.era-3 .answer-input {
    background: rgba(15, 30, 55, 0.95);
    border: 4px solid rgba(70, 180, 255, 0.75);
    box-shadow: 0 0 25px rgba(60, 160, 255, 0.3);
}
body.era-3 .answer-input:focus {
    border-color: rgba(100, 210, 255, 1);
    box-shadow: 0 0 50px rgba(80, 190, 255, 0.55);
}

body.era-4 .answer-input {
    background: rgba(20, 15, 40, 0.95);
    border: 4px solid transparent;
    border-image: linear-gradient(135deg, rgba(255, 100, 150, 0.8), rgba(100, 200, 255, 0.8)) 1;
    box-shadow: 0 0 30px rgba(150, 100, 255, 0.35);
}
body.era-4 .answer-input:focus {
    box-shadow: 0 0 60px rgba(180, 130, 255, 0.6), 0 0 100px rgba(100, 200, 255, 0.3);
}

.answer-input.correct {
    border-color: #9ed;
    box-shadow: 0 0 40px rgba(150, 240, 220, 0.55);
}

.matrix-input-area {
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
}

.matrix-display {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 16px;
    flex-wrap: wrap;
    justify-content: center;
}

.matrix-visual {
    display: grid;
    gap: 6px;
    background: linear-gradient(180deg, rgba(10, 60, 40, 0.7) 0%, rgba(5, 50, 30, 0.75) 100%);
    padding: 12px;
    border-radius: 12px;
    border: 2px solid rgba(140, 255, 200, 0.5);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 30px rgba(120, 240, 180, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.matrix-visual.cols-1 { grid-template-columns: 1fr; }
.matrix-visual.cols-2 { grid-template-columns: repeat(2, 1fr); }
.matrix-visual.cols-3 { grid-template-columns: repeat(3, 1fr); }

.matrix-visual-cell {
    min-width: 40px;
    height: 34px;
    padding: 0 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: #dff;
    background: rgba(0, 50, 30, 0.75);
    border-radius: 5px;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    text-shadow: 0 0 10px rgba(200, 255, 240, 0.4);
}

.matrix-op {
    font-size: 30px;
    color: rgba(220, 255, 245, 0.95);
    padding: 0 8px;
    text-shadow: 0 0 15px rgba(190, 255, 230, 0.6);
}

.matrix-grid {
    display: grid;
    gap: 8px;
    background: linear-gradient(180deg, rgba(10, 55, 35, 0.75) 0%, rgba(5, 45, 28, 0.8) 100%);
    padding: 16px;
    border-radius: 14px;
    border: 2px solid rgba(140, 255, 220, 0.5);
    box-shadow: 0 6px 25px rgba(0, 0, 0, 0.35), 0 0 35px rgba(140, 255, 220, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.06);
}

.matrix-grid.matrix-1x2 { grid-template-columns: repeat(2, 1fr); }
.matrix-grid.matrix-1x3 { grid-template-columns: repeat(3, 1fr); }
.matrix-grid.matrix-2x1 { grid-template-columns: 1fr; }
.matrix-grid.matrix-3x1 { grid-template-columns: 1fr; }
.matrix-grid.matrix-2x2 { grid-template-columns: repeat(2, 1fr); }
.matrix-grid.matrix-3x3 { grid-template-columns: repeat(3, 1fr); }

.matrix-cell {
    width: 65px;
    height: 44px;
    background: rgba(12, 28, 20, 0.96);
    border: 3px solid rgba(120, 240, 180, 0.6);
    border-radius: 6px;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    font-size: 20px;
    color: #fff;
    text-align: center;
    outline: none;
    transition: border-color 0.15s, box-shadow 0.15s;
    box-shadow: 0 0 10px rgba(100, 200, 160, 0.2);
}

.matrix-cell:focus {
    border-color: rgba(140, 255, 220, 0.95);
    box-shadow: 0 0 25px rgba(140, 255, 220, 0.55);
    background: rgba(20, 55, 40, 0.98);
}

.queue-list {
    display: flex;
    flex-direction: column;
    height: 80px;
    overflow: hidden;
    margin-top: 12px;
}

.queue-item {
    font-size: 18px;
    color: rgba(255, 255, 255, 0.5);
    white-space: nowrap;
    text-align: center;
    overflow: hidden;
    text-overflow: ellipsis;
}

.streak-bar {
    display: none;
}

.streak-fill {
    height: 100%;
    background: linear-gradient(90deg, #7ca, #ec9, #e99);
    width: 0%;
    transition: width 0.15s;
}

.shop-panel {
    position: fixed;
    top: 54px;
    right: 0;
    bottom: 0;
    width: 350px;
    background: linear-gradient(180deg, rgba(20, 28, 24, 0.97) 0%, rgba(15, 22, 18, 0.98) 100%);
    border-left: 2px solid rgba(150, 200, 170, 0.3);
    padding: 18px;
    display: flex;
    flex-direction: column;
    backdrop-filter: blur(16px);
    overflow: hidden;
    box-shadow: -8px 0 50px rgba(0, 0, 0, 0.4), inset 1px 0 0 rgba(255, 255, 255, 0.04);
}

.shop-panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100px;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.02) 0%, transparent 100%);
    pointer-events: none;
}

body.era-1 .shop-panel {
    background: linear-gradient(180deg, rgba(70, 55, 35, 0.95) 0%, rgba(50, 38, 25, 0.97) 100%);
    border-left: 3px solid rgba(200, 160, 80, 0.6);
}

body.era-2 .shop-panel {
    background: linear-gradient(180deg, rgba(55, 35, 15, 0.95) 0%, rgba(40, 25, 10, 0.97) 100%);
    border-left: 3px solid rgba(255, 130, 40, 0.7);
}

body.era-3 .shop-panel {
    background: linear-gradient(180deg, rgba(15, 30, 55, 0.95) 0%, rgba(10, 22, 42, 0.97) 100%);
    border-left: 3px solid rgba(70, 170, 255, 0.6);
}

body.era-4 .shop-panel {
    background: linear-gradient(180deg, rgba(22, 18, 45, 0.95) 0%, rgba(15, 12, 35, 0.97) 100%);
    border-left: 3px solid transparent;
    border-image: linear-gradient(180deg, rgba(255, 100, 150, 0.7), rgba(100, 200, 255, 0.7), rgba(150, 255, 150, 0.7)) 1;
    box-shadow: -5px 0 50px rgba(150, 100, 255, 0.2);
}

.shop-section {
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.shop-section.facilities-section {
    height: calc(66.67% - 10px);
    border-bottom: 2px solid rgba(255, 255, 255, 0.15);
    padding-bottom: 10px;
    margin-bottom: 10px;
}

.shop-section.upgrades-section {
    height: calc(33.33% - 30px);
}

.section-header {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.85);
    letter-spacing: 0.25em;
    padding: 10px 0;
    border-bottom: 2px solid rgba(255, 255, 255, 0.2);
    margin-bottom: 10px;
    text-align: center;
    flex-shrink: 0;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

body.era-1 .section-header {
    color: #f0c080;
    border-color: rgba(240, 180, 100, 0.5);
    text-shadow: 0 0 15px rgba(220, 160, 80, 0.6);
}

body.era-2 .section-header {
    color: #ffb060;
    border-color: rgba(255, 160, 70, 0.5);
    text-shadow: 0 0 15px rgba(255, 140, 50, 0.6);
}

body.era-3 .section-header {
    color: #90d0ff;
    border-color: rgba(130, 200, 255, 0.5);
    text-shadow: 0 0 15px rgba(120, 200, 255, 0.6);
}

body.era-4 .section-header {
    color: #b0f0ff;
    border-color: rgba(170, 240, 255, 0.5);
    text-shadow: 0 0 20px rgba(160, 240, 255, 0.7);
}

.section-content {
    display: flex;
    flex-direction: column;
    gap: 6px;
    flex: 1;
    overflow-y: auto;
    min-height: 0;
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
}

.section-content::-webkit-scrollbar {
    width: 6px;
}

.section-content::-webkit-scrollbar-track {
    background: transparent;
}

.section-content::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
}

.section-content::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
}

.shop-item {
    width: 100%;
    background: linear-gradient(180deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0.55) 100%);
    border: 2px solid rgba(255, 255, 255, 0.25);
    color: #fff;
    font-family: 'Fixedsys Excelsior 3.01', monospace;
    padding: 10px 12px;
    min-height: 54px;
    cursor: pointer;
    transition: all 0.15s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
    text-align: left;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.06);
    overflow: hidden;
}

.shop-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.05) 0%, transparent 100%);
    pointer-events: none;
    border-radius: 10px 10px 0 0;
}

.shop-item::after {
    content: '';
    position: absolute;
    top: 1px;
    left: 10px;
    right: 10px;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
    pointer-events: none;
}

.shop-item:hover:not(:disabled):not(.locked) {
    background: linear-gradient(135deg, rgba(180, 240, 210, 0.35) 0%, rgba(160, 220, 190, 0.2) 100%);
    border-color: rgba(180, 255, 220, 0.7);
    transform: translateX(-4px);
    box-shadow: 0 6px 25px rgba(120, 220, 180, 0.4);
}

.shop-item:disabled { opacity: 0.55; cursor: not-allowed; }

.shop-item.locked {
    opacity: 0.45;
    filter: grayscale(0.75);
    cursor: not-allowed;
}

.shop-item.locked::after {
    content: 'üîí';
    position: absolute;
    right: 12px;
    font-size: 14px;
}

.shop-item.mystery {
    opacity: 0.55;
    filter: grayscale(0.55) blur(1px);
    background: rgba(100, 100, 100, 0.25) !important;
    border-color: rgba(120, 120, 120, 0.35) !important;
}

.shop-item.mystery .item-name {
    color: rgba(220, 220, 220, 0.75);
    font-style: italic;
}

.shop-item.mystery .item-desc {
    color: rgba(170, 170, 170, 0.65);
}

.shop-item.mystery::after {
    content: '‚ùì';
}

.shop-item.maxed {
    border-color: rgba(240, 220, 140, 0.4);
    background: rgba(240, 220, 140, 0.12);
}

.shop-item.era-1 { 
    border-left: 4px solid #ffc060;
    background: linear-gradient(135deg, rgba(80, 55, 25, 0.9) 0%, rgba(50, 35, 15, 0.95) 100%);
    border-color: rgba(200, 160, 100, 0.7);
}
.shop-item.era-1:hover:not(:disabled):not(.locked) {
    background: linear-gradient(135deg, rgba(110, 80, 40, 0.95) 0%, rgba(80, 55, 25, 0.95) 100%);
    border-color: #ffd080;
    box-shadow: 0 0 15px rgba(255, 200, 100, 0.4);
}

.shop-item.era-2 { 
    border-left: 4px solid #ff8030;
    background: linear-gradient(135deg, rgba(80, 40, 15, 0.9) 0%, rgba(50, 25, 10, 0.95) 100%);
    border-color: rgba(255, 130, 50, 0.7);
}
.shop-item.era-2:hover:not(:disabled):not(.locked) {
    background: linear-gradient(135deg, rgba(110, 60, 25, 0.95) 0%, rgba(80, 45, 15, 0.95) 100%);
    border-color: #ffa050;
    box-shadow: 0 0 15px rgba(255, 140, 60, 0.4);
}

.shop-item.era-3 { 
    border-left: 4px solid #40c0ff;
    background: linear-gradient(135deg, rgba(20, 50, 90, 0.9) 0%, rgba(10, 30, 60, 0.95) 100%);
    border-color: rgba(80, 180, 255, 0.7);
}
.shop-item.era-3:hover:not(:disabled):not(.locked) {
    background: linear-gradient(135deg, rgba(35, 75, 130, 0.95) 0%, rgba(20, 50, 90, 0.95) 100%);
    border-color: #60d0ff;
    box-shadow: 0 0 15px rgba(100, 200, 255, 0.4);
}

.shop-item.era-4 { 
    border-left: 4px solid #c080ff;
    background: linear-gradient(135deg, rgba(50, 30, 80, 0.9) 0%, rgba(30, 20, 50, 0.95) 100%);
    border-color: rgba(180, 130, 255, 0.7);
}
.shop-item.era-4:hover:not(:disabled):not(.locked) {
    background: linear-gradient(135deg, rgba(75, 50, 120, 0.95) 0%, rgba(50, 35, 80, 0.95) 100%);
    border-color: #d0a0ff;
    box-shadow: 0 0 20px rgba(200, 150, 255, 0.4);
}

.shop-item.upgrade { border-color: rgba(220, 190, 140, 0.22); }
.shop-item.upgrade:hover:not(:disabled):not(.locked) {
    background: rgba(220, 190, 140, 0.16);
    border-color: rgba(220, 190, 140, 0.4);
}

.facility-icon {
    width: 32px;
    height: 32px;
    margin-right: 10px;
    border-radius: 4px;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.2);
    flex-shrink: 0;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
}

.shop-item.era-1 .facility-icon { box-shadow: 0 0 6px rgba(255, 200, 100, 0.5); }
.shop-item.era-2 .facility-icon { box-shadow: 0 0 6px rgba(255, 140, 50, 0.5); }
.shop-item.era-3 .facility-icon { box-shadow: 0 0 6px rgba(100, 220, 255, 0.5); }
.shop-item.era-4 .facility-icon { box-shadow: 0 0 8px rgba(200, 140, 255, 0.6); }

.item-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
    flex: 1;
    min-width: 0;
    padding-right: 8px;
}

.item-name { font-size: 13px; color: #fff; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.item-desc { font-size: 10px; color: rgba(255, 255, 255, 0.6); font-style: italic; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.item-owned { font-size: 13px; color: #8cf; font-weight: bold; }

.item-cost {
    font-size: 14px;
    color: #8ff;
    text-shadow: 0 0 12px rgba(150, 255, 255, 0.6);
    font-weight: bold;
    white-space: nowrap;
    flex-shrink: 0;
}

body.opm-boost-1 .game-box { border-color: rgba(255, 200, 100, 0.6); }
body.opm-boost-2 .game-box { border-color: rgba(255, 180, 80, 0.7); box-shadow: 0 0 50px rgba(255, 180, 80, 0.25); }
body.opm-boost-3 .game-box { border-color: rgba(255, 150, 50, 0.8); box-shadow: 0 0 60px rgba(255, 150, 50, 0.35); }
body.opm-boost-4 .game-box { border-color: rgba(255, 120, 40, 0.9); box-shadow: 0 0 80px rgba(255, 120, 40, 0.45); }
body.opm-boost-5 .game-box { border-color: rgba(255, 100, 30, 1); box-shadow: 0 0 100px rgba(255, 100, 30, 0.55); animation: opmGlow 0.5s ease-in-out infinite alternate; }

@keyframes opmGlow {
    from { box-shadow: 0 0 100px rgba(255, 100, 30, 0.55); }
    to { box-shadow: 0 0 130px rgba(255, 80, 20, 0.7); }
}

body.stage-5-plus .left-panel { border-width: 3px; }
body.stage-10-plus .game-box { border-width: 4px; }
body.stage-17-plus .shop-panel { border-width: 3px; }
body.stage-33-plus .game-box::before {
    content: '';
    position: absolute;
    top: -2px; left: -2px; right: -2px; bottom: -2px;
    border-radius: 16px;
    background: linear-gradient(45deg, transparent 30%, rgba(100, 200, 255, 0.1) 50%, transparent 70%);
    animation: shimmer 3s linear infinite;
    pointer-events: none;
}
body.stage-52-plus .game-box::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    border-radius: 14px;
    box-shadow: inset 0 0 30px rgba(140, 220, 255, 0.15);
    pointer-events: none;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.hidden { display: none !important; }

.news-bar {
    position: fixed;
    top: 38px;
    left: 0;
    right: 350px;
    height: 28px;
    background: linear-gradient(180deg, rgba(5, 10, 15, 0.92) 0%, rgba(3, 8, 12, 0.88) 100%);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    display: flex;
    align-items: center;
    padding: 0 20px;
    z-index: 400;
    overflow: hidden;
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.25);
}

.news-bar::before {
    content: '‚ñ∂';
    font-size: 10px;
    color: rgba(180, 255, 220, 0.7);
    margin-right: 12px;
    animation: newsPulse 2s ease-in-out infinite;
}

@keyframes newsPulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
}

.news-text {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.9);
    white-space: nowrap;
    animation: newsSlide 0.5s ease-out;
    letter-spacing: 0.04em;
    font-weight: bold;
    text-shadow: 0 0 20px rgba(200, 255, 230, 0.2);
}

body.era-1 .news-bar::before { color: rgba(240, 200, 140, 0.8); }
body.era-2 .news-bar::before { color: rgba(255, 160, 80, 0.8); }
body.era-3 .news-bar::before { color: rgba(100, 200, 255, 0.8); }
body.era-4 .news-bar::before { 
    color: rgba(255, 150, 200, 0.9);
    animation: newsPulse 1s ease-in-out infinite, newsRainbow 3s linear infinite;
}

@keyframes newsRainbow {
    0% { color: rgba(255, 100, 150, 0.9); }
    33% { color: rgba(100, 255, 200, 0.9); }
    66% { color: rgba(150, 100, 255, 0.9); }
    100% { color: rgba(255, 100, 150, 0.9); }
}

@keyframes newsSlide {
    from { transform: translateX(-20px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

.flicker-matrix {
    display: grid;
    gap: 0;
    font-size: 24px;
    letter-spacing: -2px;
}

.flicker-matrix.grid-2 {
    grid-template-columns: repeat(2, 1fr);
}

.flicker-matrix.grid-3 {
    grid-template-columns: repeat(3, 1fr);
    font-size: 22px;
}

.flicker-matrix.grid-4 {
    grid-template-columns: repeat(4, 1fr);
    font-size: 18px;
    letter-spacing: -3px;
}

.flicker-matrix span {
    display: block;
    text-align: center;
    width: 20px;
    height: 24px;
    line-height: 24px;
}

.symbol-flicker.glow-0 { color: #c0c0c0; text-shadow: 0 0 8px rgba(200, 200, 200, 0.5); }
.symbol-flicker.glow-1 { color: #d0e0d0; text-shadow: 0 0 12px rgba(200, 240, 200, 0.6); }
.symbol-flicker.glow-2 { color: #e0f0e0; text-shadow: 0 0 18px rgba(220, 255, 220, 0.75); }
.symbol-flicker.glow-3 { color: #e8ffe8; text-shadow: 0 0 25px rgba(230, 255, 230, 0.85); }
.symbol-flicker.glow-4 { color: #f0fff0; text-shadow: 0 0 30px rgba(250, 255, 250, 0.95); }
.symbol-flicker.glow-5 { 
    color: #fff; 
    text-shadow: 0 0 35px rgba(255, 255, 255, 1), 0 0 60px rgba(200, 255, 230, 0.8);
    animation: sigilPulse 1s ease-in-out infinite;
}
.symbol-flicker.glow-6 { 
    color: #fff; 
    text-shadow: 0 0 45px rgba(255, 255, 255, 1), 0 0 80px rgba(220, 255, 240, 0.9), 0 0 120px rgba(180, 255, 220, 0.6);
    animation: sigilPulse 0.8s ease-in-out infinite;
}

body.era-1 .symbol-flicker { color: #e0c080; text-shadow: 0 0 15px rgba(200, 160, 100, 0.8); }
body.era-1 .symbol-flicker.glow-3, 
body.era-1 .symbol-flicker.glow-4 { text-shadow: 0 0 25px rgba(220, 180, 110, 1), 0 0 40px rgba(180, 140, 80, 0.6); }
body.era-1 .symbol-flicker.glow-5,
body.era-1 .symbol-flicker.glow-6 { text-shadow: 0 0 35px rgba(255, 210, 140, 1), 0 0 60px rgba(200, 160, 90, 0.7); }

body.era-2 .symbol-flicker { color: #ff9040; text-shadow: 0 0 18px rgba(255, 130, 50, 0.9); }
body.era-2 .symbol-flicker.glow-3,
body.era-2 .symbol-flicker.glow-4 { text-shadow: 0 0 28px rgba(255, 140, 60, 1), 0 0 50px rgba(255, 100, 20, 0.7); }
body.era-2 .symbol-flicker.glow-5,
body.era-2 .symbol-flicker.glow-6 { text-shadow: 0 0 40px rgba(255, 160, 70, 1), 0 0 70px rgba(255, 120, 30, 0.8); }

body.era-3 .symbol-flicker { color: #60c8ff; text-shadow: 0 0 15px rgba(80, 190, 255, 0.85); }
body.era-3 .symbol-flicker.glow-3,
body.era-3 .symbol-flicker.glow-4 { text-shadow: 0 0 25px rgba(100, 210, 255, 1), 0 0 50px rgba(70, 170, 255, 0.6); }
body.era-3 .symbol-flicker.glow-5,
body.era-3 .symbol-flicker.glow-6 { text-shadow: 0 0 40px rgba(120, 230, 255, 1), 0 0 70px rgba(90, 200, 255, 0.7); }

body.era-4 .symbol-flicker { 
    background: linear-gradient(45deg, #ff8080, #ffff80, #80ff80, #80ffff, #8080ff, #ff80ff);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: rainbowSigil 2s ease infinite;
    filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.8));
}
body.era-4 .symbol-flicker.glow-4,
body.era-4 .symbol-flicker.glow-5 { filter: drop-shadow(0 0 25px rgba(255, 255, 255, 0.9)) drop-shadow(0 0 40px rgba(200, 150, 255, 0.6)); }
body.era-4 .symbol-flicker.glow-6 { 
    filter: drop-shadow(0 0 35px rgba(255, 255, 255, 1)) drop-shadow(0 0 60px rgba(200, 150, 255, 0.8));
    animation: rainbowSigil 1.5s ease infinite, sigilPulseIntense 0.5s ease-in-out infinite;
}

@keyframes rainbowSigil {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes sigilPulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.03); opacity: 0.9; }
}

@keyframes sigilPulseIntense {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.06); opacity: 0.85; }
}

.sigil-particles,
.sigil-particles-extra,
.sigil-particles-intense {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100px;
    height: 100px;
    transform: translate(-50%, -50%);
    pointer-events: none;
}

.sigil-particles::before,
.sigil-particles::after {
    content: '‚ú¶';
    position: absolute;
    font-size: 10px;
    animation: particleFloat 2s ease-in-out infinite;
}

.sigil-particles::before {
    top: -15px;
    left: 50%;
    color: #4ecdc4;
    text-shadow: 0 0 8px #4ecdc4;
    animation-delay: 0s;
}

.sigil-particles::after {
    bottom: -15px;
    right: 10%;
    color: #ffe66d;
    text-shadow: 0 0 8px #ffe66d;
    animation-delay: 1s;
}

.sigil-particles-extra::before,
.sigil-particles-extra::after {
    content: '‚óÜ';
    position: absolute;
    font-size: 8px;
    animation: particleOrbit 3s linear infinite;
}

.sigil-particles-extra::before {
    top: 0;
    right: -10px;
    color: #ff6b6b;
    text-shadow: 0 0 6px #ff6b6b;
}

.sigil-particles-extra::after {
    bottom: 0;
    left: -10px;
    color: #a8e6cf;
    text-shadow: 0 0 6px #a8e6cf;
    animation-delay: 1.5s;
}

.sigil-particles-intense::before,
.sigil-particles-intense::after {
    content: '‚òÖ';
    position: absolute;
    font-size: 12px;
    animation: particlePulse 1.5s ease-in-out infinite;
}

.sigil-particles-intense::before {
    top: -20px;
    left: -15px;
    color: #ff9ff3;
    text-shadow: 0 0 12px #ff9ff3;
}

.sigil-particles-intense::after {
    bottom: -20px;
    right: -15px;
    color: #54a0ff;
    text-shadow: 0 0 12px #54a0ff;
    animation-delay: 0.75s;
}

.complexity-section {
    position: relative;
}

@keyframes particleFloat {
    0%, 100% { transform: translateY(0) scale(1); opacity: 0.7; }
    50% { transform: translateY(-8px) scale(1.3); opacity: 1; }
}

@keyframes particleOrbit {
    0% { transform: rotate(0deg) translateX(5px) rotate(0deg); }
    100% { transform: rotate(360deg) translateX(5px) rotate(-360deg); }
}

@keyframes particlePulse {
    0%, 100% { transform: scale(1); opacity: 0.6; }
    50% { transform: scale(1.5); opacity: 1; }
}

.shop-panel {
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
}

.shop-panel::-webkit-scrollbar {
    width: 8px;
}

.shop-panel::-webkit-scrollbar-track {
    background: transparent;
}

.shop-panel::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
}

.shop-panel::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
}

@keyframes correctPulse {
    0% { background: rgba(100, 255, 100, 0.15); }
    100% { background: transparent; }
}

.game-box.correct-flash {
    animation: correctPulse 0.3s ease-out;
}

.shop-item.type-tiered { border-left: 3px solid #fa8; }
.shop-item.type-synergy { border-left: 3px solid #a8f; }
.shop-item.type-general { border-left: 3px solid #8fa; }
.shop-item.type-pet { border-left: 3px solid #f8a; }
.shop-item.bought { display: none; }

.shop-item[title] {
    position: relative;
}

.shop-item[title]:hover::after {
    content: attr(title);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(180deg, rgba(25, 35, 45, 0.99) 0%, rgba(15, 22, 30, 0.99) 100%);
    color: #fff;
    padding: 14px 20px;
    border-radius: 12px;
    font-size: 15px;
    white-space: nowrap;
    z-index: 1000;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6), 0 0 40px rgba(100, 180, 150, 0.15);
    border: 2px solid rgba(150, 220, 180, 0.4);
    margin-bottom: 12px;
    pointer-events: none;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    font-weight: bold;
    letter-spacing: 0.02em;
}

.pets-container {
    position: fixed;
    bottom: 0;
    left: 20px;
    height: 150px;
    display: flex;
    flex-direction: row;
    align-items: flex-end;
    gap: 25px;
    z-index: 200;
    pointer-events: none;
}

.pet {
    width: 100px;
    cursor: pointer;
    pointer-events: auto;
    transition: transform 0.2s ease;
    animation: petIdle 3s ease-in-out infinite;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    flex-shrink: 0;
}

.pet:hover {
    transform: scale(1.1);
    bottom: 10px;
}

.pet.pet-clicked {
    animation: petBob 0.4s ease;
}

@keyframes petBob {
    0%, 100% { transform: translateY(0) scale(1); }
    25% { transform: translateY(-20px) scale(1.08); }
    50% { transform: translateY(-10px) scale(1.04); }
    75% { transform: translateY(-15px) scale(1.06); }
}

.pet-image {
    width: 90px;
    height: 90px;
    object-fit: contain;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.5));
    transition: filter 0.2s ease, transform 0.2s ease;
}

.pet:hover .pet-image {
    filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.6)) brightness(1.15);
    transform: scale(1.05);
}

.pet-nikodemus .pet-image {
    filter: drop-shadow(0 4px 12px rgba(180, 140, 80, 0.5)) sepia(0.1);
    animation: nikodemusPulse 4s ease-in-out infinite;
}

.pet-bjartur .pet-image {
    filter: drop-shadow(0 4px 15px rgba(255, 140, 50, 0.5)) saturate(1.2);
    animation: bjarturPulse 3.5s ease-in-out infinite;
}

.pet-yuki {
    position: relative;
}

.pet-yuki::before {
    content: '';
    position: absolute;
    top: 45%;
    left: 50%;
    width: 110px;
    height: 110px;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle, rgba(100, 200, 255, 0.4) 0%, rgba(100, 200, 255, 0.2) 40%, transparent 70%);
    border-radius: 50%;
    animation: yukiAura 2s ease-in-out infinite;
    z-index: -1;
    pointer-events: none;
}

.pet-yuki .pet-image {
    filter: drop-shadow(0 0 15px rgba(100, 200, 255, 0.8)) drop-shadow(0 0 30px rgba(100, 200, 255, 0.5)) drop-shadow(0 0 45px rgba(150, 220, 255, 0.3)) brightness(1.05);
    animation: yukiGlow 2s ease-in-out infinite;
}

.pet-aineko {
    position: relative;
}

.pet-aineko::before {
    content: '';
    position: absolute;
    top: 45%;
    left: 50%;
    width: 130px;
    height: 130px;
    transform: translate(-50%, -50%);
    background: conic-gradient(from 0deg, 
        rgba(255, 50, 100, 0.6), 
        rgba(255, 150, 50, 0.6), 
        rgba(255, 255, 50, 0.6), 
        rgba(50, 255, 100, 0.6), 
        rgba(50, 200, 255, 0.6), 
        rgba(150, 50, 255, 0.6), 
        rgba(255, 50, 200, 0.6),
        rgba(255, 50, 100, 0.6)
    );
    border-radius: 50%;
    animation: ainekoFlameRotate 2s linear infinite;
    filter: blur(15px);
    z-index: -1;
    pointer-events: none;
}

.pet-aineko::after {
    content: '';
    position: absolute;
    top: 45%;
    left: 50%;
    width: 100px;
    height: 120px;
    transform: translate(-50%, -55%);
    background: linear-gradient(0deg, 
        transparent 0%,
        rgba(255, 100, 150, 0.3) 20%,
        rgba(255, 200, 100, 0.4) 40%,
        rgba(255, 255, 150, 0.3) 60%,
        rgba(150, 255, 200, 0.2) 80%,
        transparent 100%
    );
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    animation: ainekoFlameFlicker 0.15s ease-in-out infinite alternate, ainekoFlameWave 1s ease-in-out infinite;
    filter: blur(8px);
    z-index: -1;
    pointer-events: none;
}

.pet-aineko .pet-image {
    filter: drop-shadow(0 0 20px rgba(255, 100, 200, 0.8)) drop-shadow(0 0 40px rgba(100, 200, 255, 0.6)) drop-shadow(0 0 60px rgba(200, 100, 255, 0.4));
    animation: ainekoRainbow 3s linear infinite;
}

@keyframes nikodemusPulse {
    0%, 100% { filter: drop-shadow(0 4px 12px rgba(180, 140, 80, 0.5)) sepia(0.1); }
    50% { filter: drop-shadow(0 6px 18px rgba(200, 160, 100, 0.7)) sepia(0.15); }
}

@keyframes bjarturPulse {
    0%, 100% { filter: drop-shadow(0 4px 15px rgba(255, 140, 50, 0.5)) saturate(1.2); }
    50% { filter: drop-shadow(0 6px 22px rgba(255, 160, 70, 0.7)) saturate(1.4); }
}

@keyframes yukiAura {
    0%, 100% { 
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.8;
    }
    50% { 
        transform: translate(-50%, -50%) scale(1.15);
        opacity: 1;
    }
}

@keyframes yukiGlow {
    0%, 100% { 
        filter: drop-shadow(0 0 15px rgba(100, 200, 255, 0.8)) drop-shadow(0 0 30px rgba(100, 200, 255, 0.5)) drop-shadow(0 0 45px rgba(150, 220, 255, 0.3)) brightness(1.05);
    }
    50% { 
        filter: drop-shadow(0 0 25px rgba(120, 220, 255, 1)) drop-shadow(0 0 50px rgba(120, 220, 255, 0.7)) drop-shadow(0 0 70px rgba(180, 240, 255, 0.4)) brightness(1.1);
    }
}

@keyframes ainekoFlameRotate {
    0% { transform: translate(-50%, -50%) rotate(0deg) scale(1); }
    50% { transform: translate(-50%, -50%) rotate(180deg) scale(1.1); }
    100% { transform: translate(-50%, -50%) rotate(360deg) scale(1); }
}

@keyframes ainekoFlameFlicker {
    0% { opacity: 0.7; }
    100% { opacity: 1; }
}

@keyframes ainekoFlameWave {
    0%, 100% { 
        transform: translate(-50%, -55%) scaleX(1) scaleY(1);
    }
    25% { 
        transform: translate(-48%, -57%) scaleX(0.95) scaleY(1.05);
    }
    50% { 
        transform: translate(-50%, -53%) scaleX(1.05) scaleY(0.95);
    }
    75% { 
        transform: translate(-52%, -56%) scaleX(0.98) scaleY(1.02);
    }
}

@keyframes ainekoRainbow {
    0% { filter: drop-shadow(0 0 20px rgba(255, 100, 150, 0.9)) drop-shadow(0 0 40px rgba(255, 100, 150, 0.6)) drop-shadow(0 0 60px rgba(255, 100, 150, 0.3)); }
    16% { filter: drop-shadow(0 0 20px rgba(255, 200, 100, 0.9)) drop-shadow(0 0 40px rgba(255, 200, 100, 0.6)) drop-shadow(0 0 60px rgba(255, 200, 100, 0.3)); }
    33% { filter: drop-shadow(0 0 20px rgba(100, 255, 150, 0.9)) drop-shadow(0 0 40px rgba(100, 255, 150, 0.6)) drop-shadow(0 0 60px rgba(100, 255, 150, 0.3)); }
    50% { filter: drop-shadow(0 0 20px rgba(100, 200, 255, 0.9)) drop-shadow(0 0 40px rgba(100, 200, 255, 0.6)) drop-shadow(0 0 60px rgba(100, 200, 255, 0.3)); }
    66% { filter: drop-shadow(0 0 20px rgba(150, 100, 255, 0.9)) drop-shadow(0 0 40px rgba(150, 100, 255, 0.6)) drop-shadow(0 0 60px rgba(150, 100, 255, 0.3)); }
    83% { filter: drop-shadow(0 0 20px rgba(255, 100, 200, 0.9)) drop-shadow(0 0 40px rgba(255, 100, 200, 0.6)) drop-shadow(0 0 60px rgba(255, 100, 200, 0.3)); }
    100% { filter: drop-shadow(0 0 20px rgba(255, 100, 150, 0.9)) drop-shadow(0 0 40px rgba(255, 100, 150, 0.6)) drop-shadow(0 0 60px rgba(255, 100, 150, 0.3)); }
}

.pet-name {
    background: linear-gradient(180deg, rgba(40, 35, 30, 0.95) 0%, rgba(25, 22, 18, 0.98) 100%);
    color: #fff;
    font-size: 12px;
    font-weight: bold;
    padding: 5px 12px;
    border-radius: 10px;
    border: 2px solid rgba(255, 255, 255, 0.4);
    text-shadow: 0 0 6px rgba(255, 255, 255, 0.6);
    margin-top: -8px;
    letter-spacing: 0.08em;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.5);
    white-space: nowrap;
    z-index: 10;
    position: relative;
}

.pet-nikodemus .pet-name {
    background: linear-gradient(180deg, rgba(120, 85, 50, 0.95) 0%, rgba(70, 45, 28, 0.98) 100%);
    border-color: rgba(240, 200, 140, 0.7);
    color: #ffe8c8;
    box-shadow: 0 3px 15px rgba(180, 130, 60, 0.4);
}

.pet-bjartur .pet-name {
    background: linear-gradient(180deg, rgba(100, 70, 45, 0.95) 0%, rgba(60, 40, 28, 0.98) 100%);
    border-color: rgba(255, 180, 100, 0.7);
    color: #ffe0b0;
    box-shadow: 0 3px 15px rgba(255, 140, 50, 0.4);
}

.pet-yuki .pet-name {
    background: linear-gradient(180deg, rgba(50, 80, 120, 0.95) 0%, rgba(30, 50, 90, 0.98) 100%);
    border-color: rgba(150, 220, 255, 0.8);
    color: #d0f0ff;
    text-shadow: 0 0 10px rgba(120, 200, 255, 0.8);
    box-shadow: 0 3px 20px rgba(100, 180, 255, 0.5);
}

.pet-aineko .pet-name {
    background: linear-gradient(135deg, rgba(100, 50, 130, 0.95), rgba(50, 80, 130, 0.95));
    border-color: rgba(220, 170, 255, 0.8);
    color: #fff;
    text-shadow: 0 0 12px rgba(255, 180, 255, 0.9);
    animation: ainekoNameGlow 2s ease infinite;
    box-shadow: 0 3px 20px rgba(180, 120, 255, 0.5);
}

@keyframes ainekoNameGlow {
    0%, 100% { box-shadow: 0 3px 15px rgba(180, 120, 255, 0.5); border-color: rgba(220, 170, 255, 0.8); }
    50% { box-shadow: 0 3px 25px rgba(220, 160, 255, 0.8); border-color: rgba(255, 200, 255, 1); }
}

@keyframes petIdle {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
}

.pet-speech {
    position: absolute;
    bottom: 110px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    background: rgba(255, 255, 255, 0.98);
    color: #333;
    padding: 10px 16px;
    border-radius: 14px;
    font-size: 15px;
    font-style: italic;
    font-weight: bold;
    white-space: nowrap;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transition: all 0.2s ease;
    z-index: 210;
    border: 2px solid rgba(0, 0, 0, 0.1);
}


.pet-speech::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    border: 10px solid transparent;
    border-top-color: rgba(255, 255, 255, 0.98);
    border-bottom: none;
}

.pet-speech.show {
    opacity: 1;
    transform: translateX(-50%) scale(1);
}

body.era-1 .pet-nikodemus { filter: drop-shadow(0 0 12px rgba(200, 160, 100, 0.6)); }
body.era-2 .pet-bjartur { filter: drop-shadow(0 0 12px rgba(255, 140, 50, 0.6)); }
body.era-3 .pet-yuki { filter: drop-shadow(0 0 18px rgba(100, 180, 255, 0.7)); }
body.era-4 .pet-aineko { filter: drop-shadow(0 0 25px rgba(180, 130, 255, 0.8)); }
